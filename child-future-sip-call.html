<!DOCTYPE html>
<html lang="en-US">

<head>
    <meta charset="UTF-8">
    <title>Mutual Fund Sahi hai</title>
    <meta name="description" content="Mutual Fund Sahi hai" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="profile" href="https://gmpg.org/xfn/11">
    <link rel="canonical" href="Replace_with_your_PAGE_URL" />

    <!-- Stylesheets -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/main.css" rel="stylesheet">
    <link href="css/responsive.css" rel="stylesheet">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link
        href="https://fonts.googleapis.com/css2?family=Heebo:wght@100;300;400;500;600;700;800;900&family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap"
        rel="stylesheet">

    <!-- Add site Favicon -->
    <link rel="shortcut icon" href="images/favicon.png" type="image/x-icon">
    <link rel="icon" href="images/favicon.png" type="image/x-icon">
    <meta name="msapplication-TileImage" content="images/favicon.png" />
</head>

<body class="overflow-h">

    <div class="page-wrapper">

        <!-- Main Header-->
        <header class="main-header">
            <div class="header-upper">
                <div class="outer-container">
                    <div class="inner-container clearfix">
                        <div class="pull-left logo-box">
                            <div class="logo"><a href="index.html"><img src="images/bhaarat-nivesh-yatra.svg" alt=""
                                        title=""></a></div>
                        </div>

                        <div class="outer-box clearfix pull-right logo-box">
                            <div class="logo"><a href="index.html"><img src="images/mutual-fund-sahi-hai.svg" alt=""
                                        title=""></a></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mobile-menu">
                <div class="menu-backdrop"></div>
                <div class="close-btn"><span class="icon lnr lnr-cross"></span></div>
                <nav class="menu-box">
                    <div class="nav-logo"><a href="index.html"><img src="images/logo-2.png" alt="" title=""></a></div>
                    <div class="menu-outer"></div>
                </nav>
            </div>
        </header>

        <section class="contact-page-section bg-image pt-0 icon-box-main">
            <img src="images/icon4.svg" class="icon-inner">
            <div class=" bg-color2 ">
                <div class="auto-container padd-70 pb-30">
                    <p class="text-center mt-2 mb-30">
                        <span class="gradient-button">Goal SIP Calculator</span>
                    <p class="feed-back-head text-center">Determine the monthly SIP investments you need to make for
                        your child's future.
                    </p>
                    </p>
                    <div class="form-center-box1 mb-30">
                        <div class="row clearfix">
                            <div class="col-md-8">
                                <div class="row gola-sip-range align-items-center">
                                    <div class="col-md-8">
                                        <label for="formControlRange" class="range-title">Monthly Investment (₹)</label>
                                    </div>
                                    <div class="col-md-4">
                                        <input type="number" id="output1" class="goal-sip-amt" value="1000" />
                                    </div>
                                    <div class="col-md-12">
                                        <input type="range" min="500" max="500000" value="500" step="500"
                                            class="form-control-range range-slider" id="slider1">
                                    </div>
                                </div>
                                <div class="row gola-sip-range align-items-center">
                                    <div class="col-md-8">
                                        <label for="formControlRange" class="range-title">Investment Duration (In
                                            Years)</label>
                                    </div>
                                    <div class="col-md-4">
                                        <input type="number" id="output2" class="goal-sip-amt" value="1" />
                                    </div>
                                    <div class="col-md-12">
                                        <input type="range" min="1" max="50" value="1"
                                            class="form-control-range range-slider" id="slider2">
                                    </div>
                                </div>
                                <div class="row gola-sip-range align-items-center mb-0">
                                    <div class="col-md-8">
                                        <label for="formControlRange" class="range-title">Expected Rate of Return %
                                            (p.a.)</label>
                                    </div>
                                    <div class="col-md-4">
                                        <input type="number" id="output3" class="goal-sip-amt" value="12" />
                                    </div>
                                    <div class="col-md-12">
                                        <input type="range" min="3" max="15" value="0.5"
                                            class="form-control-range range-slider" id="slider3">
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="goal-sip-am-box">
                                    <div class="row">
                                        <div class="col-md-12 align-self-start">
                                            <p class="goal-sip-f-amt">
                                                Your Maturity Amount:<br>
                                                <span id="maturityAmount">₹0.00</span>
                                            </p>
                                        </div>
                                        <div class="col-md-12 align-self-end">
                                            <p class="goal-sip-f-amt">
                                                Total Investment:<br>
                                                <span id="totalInvestment">₹0.00</span>
                                            </p>
                                        </div>
                                    </div>

                                </div>
                            </div>
                            <div class="col-md-12">
                                <div class="goal-sip-amt-box">
                                    <div class="goal-sip-amt-box">
                                        <p id="investment-summary"></p>
                                    </div>
                                    <span id="countdown"></span>


                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row clearfix">
                        <div class="col-lg-12 col-md-12 col-sm-12 form-group Center">
                            <h3 class="white-text">DISCLAIMER</h3>
                            <p class="white-text">Past performance may or may not be sustained in future and is not a
                                guarantee of any future returns. Please note that these calculators are for
                                illustrations only and do not represent actual returns. Mutual Funds do not have a fixed
                                rate of return and it is not possible to predict the rate of return. Mutual Fund
                                investments are subject to market risks, read all scheme related documents carefully.
                            </p>
                            <div class="col-lg-12 col-md-12 col-sm-12 form-group Center msg-btn">
                                <button class="theme-btn btn-style-one" type="submit" name="submit-form"
                                    onclick="submitForm()"><span class="txt">Submit</span></button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </div>

    <!-- Scroll To Top -->
    <div class="scroll-to-top scroll-to-target" data-target="html"><span class="fa fa-arrow-circle-up"></span></div>

    <script src="js/jquery.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/config.js" type="module"></script>
    <script type="module">
        import { startTimer } from "../js/helper.js";
        let intervalId;

        function setupSlider(sliderId, outputId, min, max) {
            var slider = document.getElementById(sliderId);
            var output = document.getElementById(outputId);
            output.value = slider.value;

            // Update slider on input from the field
            slider.oninput = function () {
                output.value = this.value;
                calculateSIP();
            };

            // Validate output field and update slider
            output.oninput = function () {
                let val = parseFloat(this.value);
                if (val < min || val > max) {
                    alert(`Please enter a value between ${min} and ${max}`);
                    this.value = val < min ? min : max;
                }
                slider.value = this.value;
                calculateSIP();
            };
        }

        function calculateSIP() {
            let P = parseFloat(document.getElementById('output1').value); // Monthly investment amount
            let n = parseFloat(document.getElementById('output2').value) * 12; // Duration in months
            let annualReturnRate = parseFloat(document.getElementById('output3').value) / 100; // Annual return rate
            let i = annualReturnRate / 12; // Monthly interest rate

            if (i > 0 && n > 0) {
                // SIP Maturity Calculation Formula: M = P × ((1 + i)^n – 1) / i × (1 + i)
                let maturityAmount = P * (Math.pow(1 + i, n) - 1) / i * (1 + i);
                let totalInvestment = P * n;

                document.getElementById('maturityAmount').innerText = "₹" + maturityAmount.toFixed(2);
                document.getElementById('totalInvestment').innerText = "₹" + totalInvestment.toFixed(2);
                document.getElementById('investment-summary').innerHTML = `
                <span>
                    If you invest <span class="amt-text-1">₹${P}</span> for next <span class="amt-text-1">${n / 12} years</span>, you will accumulate <span class="amt-text-2">₹${totalInvestment.toFixed(2)}</span>
                </span>`;
            } else {
                document.getElementById('maturityAmount').innerText = "₹0.00";
                document.getElementById('totalInvestment').innerText = "₹0.00";
            }
        }

        // Set up each slider with the respective min/max values
        setupSlider('slider1', 'output1', 500, 500000);
        setupSlider('slider2', 'output2', 1, 50);
        setupSlider('slider3', 'output3', 3, 15);

        // Initial SIP calculation
        calculateSIP();

        window.submitForm = async function () {
            const userId = localStorage.getItem('userId');
            let P = parseFloat(document.getElementById('output1').value); // Monthly investment amount
            let n = parseFloat(document.getElementById('output2').value) * 12; // Duration in months
            let annualReturnRate = parseFloat(document.getElementById('output3').value) / 100; // Annual return rate
            let i = annualReturnRate / 12; // Monthly interest rate

            let maturityAmount = P * (Math.pow(1 + i, n) - 1) / i * (1 + i);
            let totalInvestment = P * n;

            const data = {
                monthlyInvestment: P,
                investmentDuration: n,
                expectedROR: annualReturnRate,
                maturityAmount,
                totalInvestment,
                userId
            };

            await fetch('https://192.168.1.158:5001/api/bny/sip-calc', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            })
                .then(response => response.json())
                .then(data => {
                    window.location.replace('./thankyou.html');
                })
                .catch((error) => {
                    console.error('Error:', error);
                });
        }

        async function setGoalSelected() {
            const userId = localStorage.getItem('userId');
            try {
                fetch(`${window.baseUrl}/user-analytics/goal-selected`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ userId, goalSelected: 'Child Future' })
                })
                    .then(response => response.json())
                    .then(data => { console.log('data', data) })
            } catch (error) {
                console.error('Error setting goal', error);
            }
        }

        window.onload = function () {
            let duration = 45;
            let display = document.querySelector("#countdown");

            // Start the initial timer
            intervalId = startTimer(duration, display);

            window.onclick = function () {


                // Clear the old timer before starting a new one
                if (intervalId) {
                    clearInterval(intervalId);
                }

                // Reset the timer
                intervalId = startTimer(duration, display);
            };

            setGoalSelected();

        };

    </script>
</body>

</html>